# Security Headers for Production
# Add these headers to your web server configuration (nginx, apache, etc.)

# Prevent clickjacking
add_header X-Frame-Options "DENY" always;

# Prevent MIME type sniffing
add_header X-Content-Type-Options "nosniff" always;

# Enable XSS filtering
add_header X-XSS-Protection "1; mode=block" always;

# Strict referrer policy
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# HTTP Strict Transport Security (HTTPS only)
add_header Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" always;

# Content Security Policy
add_header Content-Security-Policy "
  default-src 'self';
  script-src 'self' 'unsafe-inline' 'unsafe-eval';
  style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
  font-src 'self' https://fonts.gstatic.com;
  img-src 'self' data: blob:;
  connect-src 'self' https://api.suifrens.sui.io https://faucet.sui.io https://fullnode.testnet.sui.io https://fullnode.mainnet.sui.io https://publisher-devnet.walrus.space https://aggregator-devnet.walrus.space https://accounts.google.com;
  frame-src 'none';
  object-src 'none';
  base-uri 'self';
  form-action 'self';
" always;

# Permissions Policy (formerly Feature Policy)
add_header Permissions-Policy "
  geolocation=(),
  midi=(),
  notifications=(),
  push=(),
  sync-xhr=(),
  microphone=(),
  camera=(),
  magnetometer=(),
  gyroscope=(),
  speaker=(),
  vibrate=(),
  fullscreen=(self),
  payment=()
" always;
